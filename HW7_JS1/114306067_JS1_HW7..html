<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>StudentID_HW7_1A2B</title>
</head>
<body>

<h1>StudentID_HW7_1A2B</h1>

<input id="guess" type="text" placeholder="四位不重複數字">
<button onclick="play()">Guess</button>

<div id="record"></div>

<script>
    var answer = makeAnswer();
    var times = 0;

    function makeAnswer() {
        var nums = [0,1,2,3,4,5,6,7,8,9];
        var ans = "";

        while (ans.length < 4) {
            var i = Math.floor(Math.random() * nums.length);
            ans += nums[i];
            nums.splice(i, 1);
        }
        return ans;
    }

    function play() {
        var input = document.getElementById("guess").value;
        input = input.trim();

        if (!checkValid(input)) {
            alert("請輸入四位且不重複的數字");
            return;
        }

        times = times + 1;

        var result = checkAB(input, answer);
        document.getElementById("record").innerHTML +=
            "第 " + times + " 次：" + input + " → " + result + "<br>";

        if (result === "4A0B") {
            alert("答對了！共猜 " + times + " 次");
        }

        document.getElementById("guess").value = "";
    }

    function checkValid(str) {
        if (str.length !== 4) return false;
        if (isNaN(str)) return false;

        for (var i = 0; i < 4; i++) {
            for (var j = i + 1; j < 4; j++) {
                if (str[i] === str[j]) return false;
            }
        }
        return true;
    }

    function checkAB(g, a) {
        var A = 0;
        var B = 0;

        for (var i = 0; i < 4; i++) {
            if (g[i] === a[i]) {
                A++;
            } else if (a.indexOf(g[i]) !== -1) {
                B++;
            }
        }
        return A + "A" + B + "B";
    }
</script>

</body>
</html>
